(function(n){var w=function(b){return b.replace(/^\/\//,"").replace(/[\/\.]/g,"_")},D=1,l,A,y,x=function(b){return b&&n.isFunction(b.always)},G=function(b){var f=[];if(x(b))return[b];else for(var g in b)x(b[g])&&f.push(b[g]);return f},H=function(b){return n.isArray(b)&&b.length===3&&b[1]==="success"?b[0]:b};l=n.View=function(b,f,g,j){if(typeof g==="function"){j=g;g=undefined}var k=G(f);if(k.length){var m=n.Deferred();k.push(y(b,true));n.when.apply(n,k).then(function(c){var e=n.makeArray(arguments),
d=e.pop()[0];if(x(f))f=H(c);else for(var h in f)if(x(f[h]))f[h]=H(e.shift());e=d(f,g);m.resolve(e);j&&j(e)});return m.promise()}else{var a;k=typeof j==="function";m=y(b,k);if(k){a=m;m.done(function(c){j(c(f,g))})}else m.done(function(c){a=c(f,g)});return a}};A=function(b,f){if(!b.match(/[^\s]/))throw"$.View ERROR: There is no template or an empty template at "+f;};y=function(b,f){return n.ajax({url:b,dataType:"view",async:f})};n.ajaxTransport("view",function(b,f){b=f.url;var g=b.match(/\.[\w\d]+$/),
j,k,m,a=b,c,e=function(d){d=j.renderer(m,d);if(l.cache)l.cached[m]=d;return{view:d}};if(k=document.getElementById(b))g=k.type.match(/\/[\d\w]+$/)[0].replace(/^\//,".");if(!g){g=l.ext;a+=l.ext}m=w(a);if(a.match(/^\/\//))a=typeof steal==="undefined"?"/"+a.substr(2):steal.root.mapJoin(a.substr(2));j=l.types[g];return{send:function(d,h){if(l.cached[m])return h(200,"success",{view:l.cached[m]});else if(k)h(200,"success",e(k.innerHTML));else c=n.ajax({async:f.async,url:a,dataType:"text",error:function(){A("",
a);h(404)},success:function(i){A(i,a);h(200,"success",e(i))}})},abort:function(){c&&c.abort()}}});n.extend(l,{hookups:{},hookup:function(b){var f=++D;l.hookups[f]=b;return f},cached:{},cache:true,register:function(b){this.types["."+b.suffix]=b;window.steal&&steal.type(b.suffix+" view js",function(f,g,j){g=l.types["."+f.type];var k=w(f.rootSrc);f.text=g.script(k,f.text);j()})},types:{},ext:".ejs",registerScript:function(b,f,g){return"$.View.preload('"+f+"',"+l.types["."+b].script(f,g)+");"},preload:function(b,
f){l.cached[b]=function(g,j){return f.call(g,g,j)}}});window.steal&&steal.type("view js",function(b,f,g){f=l.types["."+b.type];var j=w(b.rootSrc);b.text="steal('"+(f.plugin||"jquery/view/"+b.type)+"').then(function($){$.View.preload('"+j+"',"+b.text+");\n})";g()});var I,z,J,K,E,u,B;I=function(b){var f=n.fn[b];n.fn[b]=function(){var g=n.makeArray(arguments),j,k,m=this;if(x(g[0])){g[0].done(function(a){z.call(m,[a],f)});return this}else if(J(g)){if(j=E(g)){k=g[j];g[j]=function(a){z.call(m,[a],f);k.call(m,
a)};l.apply(l,g);return this}g=l.apply(l,g);if(x(g)){g.done(function(a){z.call(m,[a],f)});return this}else g=[g]}return z.call(this,g,f)}};z=function(b,f){var g;for(var j in l.hookups)break;if(j&&b[0]&&K(b[0])){g=l.hookups;l.hookups={};b[0]=n(b[0])}f=f.apply(this,b);g&&u(b[0],g);return f};J=function(b){var f=typeof b[1];return typeof b[0]=="string"&&(f=="object"||f=="function")&&!b[1].nodeType&&!b[1].jquery};K=function(b){if(b.jquery||b.nodeType===1)return true;else if(typeof b==="string"){b=n.trim(b);
return b.substr(0,1)==="<"&&b.substr(b.length-1,1)===">"&&b.length>=3}else return false};E=function(b){return typeof b[3]==="function"?3:typeof b[2]==="function"&&2};u=function(b,f){var g,j=0,k,m;b=b.filter(function(){return this.nodeType!=3});b=b.add("[data-view-id]",b);for(g=b.length;j<g;j++)if(b[j].getAttribute&&(k=b[j].getAttribute("data-view-id"))&&(m=f[k])){m(b[j],k);delete f[k];b[j].removeAttribute("data-view-id")}n.extend(l.hookups,f)};n.fn.hookup=function(){var b=l.hookups;l.hookups={};u(this,
b);return this};B=["prepend","append","after","before","text","html","replaceWith","val"];for(var r=0;r<B.length;r++)I(B[r])})(jQuery);
(function(){function n(a,c,e,d){d={data:d||(c?c.data:{}),_wrap:c?c._wrap:null,tmpl:null,parent:c||null,nodes:[],calls:H,nest:I,wrap:z,html:J,update:K};a&&jQuery.extend(d,a,{nodes:[],parent:c});if(e){d.tmpl=e;d._ctnt=d._ctnt||d.tmpl(jQuery,d);d.key=++j;(m.length?b:r)[j]=d}return d}function w(a,c,e){var d;e=e?jQuery.map(e,function(h){return typeof h==="string"?a.key?h.replace(/(<\w+)(?=[\s>])(?![^>]*_tmplitem)([^>]*)/g,"$1 "+u+'="'+a.key+'" $2'):h:w(h,a,h._ctnt)}):a;if(c)return e;e=e.join("");e.replace(/^\s*([^<\s][^<]*)?(<[\w\W]+>)([^>]*[^>\s])?\s*$/,
function(h,i,o,q){d=jQuery(o).get();G(d);if(i)d=D(i).concat(d);if(q)d=d.concat(D(q))});return d?d:D(e)}function D(a){var c=document.createElement("div");c.innerHTML=a;return jQuery.makeArray(c.childNodes)}function l(a){return new Function("jQuery","$item","var $=jQuery,call,_=[],$data=$item.data;with($data){_.push('"+jQuery.trim(a).replace(/([\\'])/g,"\\$1").replace(/[\r\t\n]/g," ").replace(/\$\{([^\}]*)\}/g,"{{= $1}}").replace(/\{\{(\/?)(\w+|.)(?:\(((?:[^\}]|\}(?!\}))*?)?\))?(?:\s+(.*?)?)?(\(((?:[^\}]|\}(?!\}))*?)\))?\s*\}\}/g,
function(c,e,d,h,i,o,q){c=jQuery.tmpl.tag[d];if(!c)throw"Template command not found: "+d;d=c._default||[];if(o&&!/\w$/.test(i)){i+=o;o=""}if(i){i=y(i);q=q?","+y(q)+")":o?")":"";q=o?i.indexOf(".")>-1?i+o:"("+i+").call($item"+q:i;o=o?q:"(typeof("+i+")==='function'?("+i+").call($item):("+i+"))"}else o=q=d.$1||"null";h=y(h);return"');"+c[e?"close":"open"].split("$notnull_1").join(i?"typeof("+i+")!=='undefined' && ("+i+")!=null":"true").split("$1a").join(o).split("$1").join(q).split("$2").join(h?h.replace(/\s*([^\(]+)\s*(\((.*?)\))?/g,
function(C,v,L,t){return(t=t?","+t+")":L?")":"")?"("+v+").call($item"+t:C}):d.$2||"")+"_.push('"})+"');}return _;")}function A(a,c){a._wrap=w(a,true,jQuery.isArray(c)?c:[B.test(c)?c:jQuery(c).html()]).join("")}function y(a){return a?a.replace(/\\'/g,"'").replace(/\\\\/g,"\\"):null}function x(a){var c=document.createElement("div");c.appendChild(a.cloneNode(true));return c.innerHTML}function G(a){function c(v){function L(M){M+=e;p=i[M]=i[M]||n(p,r[p.parent.key+e]||p.parent,null,true)}var t,s=v,p,F;
if(F=v.getAttribute(u)){for(;s.parentNode&&(s=s.parentNode).nodeType===1&&!(t=s.getAttribute(u)););if(t!==F){s=s.parentNode?s.nodeType===11?0:s.getAttribute(u)||0:0;if(!(p=r[F])){p=b[F];p=n(p,r[s]||b[s],null,true);p.key=++j;r[j]=p}k&&L(F)}v.removeAttribute(u)}else if(k&&(p=jQuery.data(v,"tmplItem"))){L(p.key);r[p.key]=p;s=(s=jQuery.data(v.parentNode,"tmplItem"))?s.key:0}if(p){for(t=p;t&&t.key!=s;){t.nodes.push(v);t=t.parent}delete p._ctnt;delete p._wrap;jQuery.data(v,"tmplItem",p)}}var e="_"+k,d,
h,i={},o,q,C;o=0;for(q=a.length;o<q;o++)if((d=a[o]).nodeType===1){h=d.getElementsByTagName("*");for(C=h.length-1;C>=0;C--)c(h[C]);c(d)}}function H(a,c,e,d){if(!a)return m.pop();m.push({_:a,tmpl:c,item:this,data:e,options:d})}function I(a,c,e){return jQuery.tmpl(jQuery.template(a),c,e,this)}function z(a,c){var e=a.options||{};e.wrapped=c;return jQuery.tmpl(jQuery.template(a.tmpl),a.data,e,a.item)}function J(a,c){var e=this._wrap;return jQuery.map(jQuery(jQuery.isArray(e)?e.join(""):e).filter(a||"*"),
function(d){return c?d.innerText||d.textContent:d.outerHTML||x(d)})}function K(){var a=this.nodes;jQuery.tmpl(null,null,null,this).insertBefore(a[0]);jQuery(a).remove()}var E=jQuery.fn.domManip,u="_tmplitem",B=/^[^<]*(<[\w\W]+>)[^>]*$|\{\{\! /,r={},b={},f,g={key:0,data:{}},j=0,k=0,m=[];jQuery.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,c){jQuery.fn[a]=function(e){var d=[];e=jQuery(e);var h,i,o;h=this.length===1&&this[0].parentNode;
f=r||{};if(h&&h.nodeType===11&&h.childNodes.length===1&&e.length===1){e[c](this[0]);d=this}else{i=0;for(o=e.length;i<o;i++){k=i;h=(i>0?this.clone(true):this).get();jQuery.fn[c].apply(jQuery(e[i]),h);d=d.concat(h)}k=0;d=this.pushStack(d,a,e.selector)}e=f;f=null;jQuery.tmpl.complete(e);return d}});jQuery.fn.extend({tmpl:function(a,c,e){return jQuery.tmpl(this[0],a,c,e)},tmplItem:function(){return jQuery.tmplItem(this[0])},template:function(a){return jQuery.template(a,this[0])},domManip:function(a,c,
e){if(a[0]&&a[0].nodeType){for(var d=jQuery.makeArray(arguments),h=a.length,i=0,o;i<h&&!(o=jQuery.data(a[i++],"tmplItem")););if(h>1)d[0]=[jQuery.makeArray(a)];if(o&&k)d[2]=function(q){jQuery.tmpl.afterManip(this,q,e)};E.apply(this,d)}else E.apply(this,arguments);k=0;f||jQuery.tmpl.complete(r);return this}});jQuery.extend({tmpl:function(a,c,e,d){var h=!d;if(h){d=g;a=jQuery.template[a]||jQuery.template(null,a);b={}}else if(!a){a=d.tmpl;r[d.key]=d;d.nodes=[];d.wrapped&&A(d,d.wrapped);return jQuery(w(d,
null,d.tmpl(jQuery,d)))}if(!a)return[];if(typeof c==="function")c=c.call(d||{});e&&e.wrapped&&A(e,e.wrapped);c=jQuery.isArray(c)?jQuery.map(c,function(i){return i?n(e,d,a,i):null}):[n(e,d,a,c)];return h?jQuery(w(d,null,c)):c},tmplItem:function(a){var c;if(a instanceof jQuery)a=a[0];for(;a&&a.nodeType===1&&!(c=jQuery.data(a,"tmplItem"))&&(a=a.parentNode););return c||g},template:function(a,c){if(c){if(typeof c==="string")c=l(c);else if(c instanceof jQuery)c=c[0]||{};if(c.nodeType)c=jQuery.data(c,"tmpl")||
jQuery.data(c,"tmpl",l(c.innerHTML));return typeof a==="string"?(jQuery.template[a]=c):c}return a?typeof a!=="string"?jQuery.template(null,a):jQuery.template[a]||jQuery.template(null,B.test(a)?a:jQuery(a)):null},encode:function(a){return(""+a).split("<").join("&lt;").split(">").join("&gt;").split('"').join("&#34;").split("'").join("&#39;")}});jQuery.extend(jQuery.tmpl,{tag:{tmpl:{_default:{$2:"null"},open:"if($notnull_1){_=_.concat($item.nest($1,$2));}"},wrap:{_default:{$2:"null"},open:"$item.calls(_,$1,$2);_=[];",
close:"call=$item.calls();_=call._.concat($item.wrap(call,_));"},each:{_default:{$2:"$index, $value"},open:"if($notnull_1){$.each($1a,function($2){with(this){",close:"}});}"},"if":{open:"if(($notnull_1) && $1a){",close:"}"},"else":{_default:{$1:"true"},open:"}else if(($notnull_1) && $1a){"},html:{open:"if($notnull_1){_.push($1a);}"},"=":{_default:{$1:"$data"},open:"if($notnull_1){_.push($.encode($1a));}"},"!":{open:""}},complete:function(){r={}},afterManip:function(a,c,e){var d=c.nodeType===11?jQuery.makeArray(c.childNodes):
c.nodeType===1?[c]:[];e.call(a,c);G(d);k++}});$.View.register({suffix:"tmpl",renderer:function(a,c){var e=$.template(null,c);return function(d){return e.call($,$,{data:d}).join("")}},script:function(a,c){return"function(data){return ("+$.template(null,c)+").call(jQuery, jQuery, {data: data}).join(''); }"}});jQuery.View.ext=".tmpl"})(jQuery);
