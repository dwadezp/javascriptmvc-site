(function(b){var c=b.event;c.selection={delay:300,preventDefault:c.supportTouch};c.setupHelper(["selectionStart","selectionEnd","selectionEnding","selectionMoving","selectionMove"],"mousedown",function(d){var f=d.delegateTarget||d.currentTarget,g=d.handleObj.selector,j=false,h=this,i=b.Range(d),l=function(a){a=b.Range(a);var e=i.compare("START_TO_START",a);return e==-1||e==0?i.clone().move("END_TO_END",a):a.clone().move("END_TO_END",i)},k=function(){b(f).unbind("mousemove",m).unbind("mouseup",n);
clearTimeout(o);i=null},n=function(a){if(j){b.each(c.find(f,["selectionMoving"],g),function(){this.call(h,a,e)});var e=l(a);k();b.each(c.find(f,["selectionEnd"],g),function(){this.call(h,d,e)})}else k()},m=function(a){if(!(a.clientX==d.clientX&&a.clientY==d.clientY)){if(!j)return k();b.each(c.find(f,["selectionMoving"],g),function(){this.call(h,a,e)});var e=l(a);b.each(c.find(f,["selectionMove"],g),function(){this.call(h,a,e)})}},p=function(){j=true;var a=c.selection.preventDefault?b.Event("selectionStart"):
d;a=b.extend(d,a);b.each(c.find(f,["selectionStart"],g),function(){this.call(h,a,i)});if(c.selection.preventDefault&&a.isDefaultPrevented()){j=false;k()}},o;if(c.selection.preventDefault){d.preventDefault();o=setTimeout(p,c.selection.delay)}else p();b(f).bind("mousemove",m).bind("mouseup",n)})})(jQuery);
