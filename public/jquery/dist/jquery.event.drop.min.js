(function(c){var l=function(h,a,b,d,e,f){return a>=d&&a<d+f&&h>=b&&h<b+e};c.fn.within=function(h,a,b){var d=[];this.each(function(){var e=jQuery(this);if(this==document.documentElement)return d.push(this);e=b?jQuery.data(this,"offsetCache")||jQuery.data(this,"offsetCache",e.offset()):e.offset();l(h,a,e.left,e.top,this.offsetWidth,this.offsetHeight)&&d.push(this)});return this.pushStack(jQuery.unique(d),"within",h+","+a)};c.fn.withinBox=function(h,a,b,d,e){var f=[];this.each(function(){var g=jQuery(this);
if(this==document.documentElement)return this.ret.push(this);var j=e?jQuery.data(this,"offset",g.offset()):g.offset(),i=g.width();g=g.height();(res=!(j.top>a+d||j.top+g<a||j.left>h+b||j.left+i<h))&&f.push(this)});return this.pushStack(jQuery.unique(f),"withinBox",jQuery.makeArray(arguments).join(","))}})(jQuery);
(function(){jQuery.fn.compare=function(c){try{c=c.jquery?c[0]:c}catch(l){return null}if(window.HTMLElement){var h=HTMLElement.prototype.toString.call(c);if(h=="[xpconnect wrapped native prototype]"||h=="[object XULElement]"||h==="[object Window]")return null}if(this[0].compareDocumentPosition)return this[0].compareDocumentPosition(c);if(this[0]==document&&c!=document)return 8;h=(this[0]!==c&&this[0].contains(c)&&16)+(this[0]!=c&&c.contains(this[0])&&8);var a=document.documentElement;if(this[0].sourceIndex){h+=
this[0].sourceIndex<c.sourceIndex&&4;h+=this[0].sourceIndex>c.sourceIndex&&2;h+=(this[0].ownerDocument!==c.ownerDocument||this[0]!=a&&this[0].sourceIndex<=0||c!=a&&c.sourceIndex<=0)&&1}else{a=document.createRange();var b=document.createRange();a.selectNode(this[0]);b.selectNode(c);a.compareBoundaryPoints(Range.START_TO_START,b)}return h}})(jQuery);
(function(c){var l=c.event,h=["dropover","dropon","dropout","dropinit","dropmove","dropend"];c.Drop=function(a,b){jQuery.extend(this,a);this.element=c(b)};c.each(h,function(){l.special[this]={add:function(){var a=c(this),b=a.data("dropEventCount")||0;a.data("dropEventCount",b+1);b==0&&c.Drop.addElement(this)},remove:function(){var a=c(this),b=a.data("dropEventCount")||0;a.data("dropEventCount",b-1);b<=1&&c.Drop.removeElement(this)}}});c.extend(c.Drop,{lowerName:"drop",_rootElements:[],_elements:c(),
last_active:[],endName:"dropon",addElement:function(a){for(var b=0;b<this._rootElements.length;b++)if(a==this._rootElements[b])return;this._rootElements.push(a)},removeElement:function(a){for(var b=0;b<this._rootElements.length;b++)if(a==this._rootElements[b]){this._rootElements.splice(b,1);return}},sortByDeepestChild:function(a,b){a=a.element.compare(b.element);if(a&16||a&4)return 1;if(a&8||a&2)return-1;return 0},isAffected:function(a,b,d){return d.element!=b.element&&d.element.within(a[0],a[1],
d._cache).length==1},deactivate:function(a,b,d){b.out(d,a);a.callHandlers(this.lowerName+"out",a.element[0],d,b)},activate:function(a,b,d){b.over(d,a);a.callHandlers(this.lowerName+"over",a.element[0],d,b)},move:function(a,b,d){a.callHandlers(this.lowerName+"move",a.element[0],d,b)},compile:function(a,b){if(this.dragging||b){if(!this.dragging){this.dragging=b;this.last_active=[]}for(var d,e,f,g=[],j=this.dragging,i=0;i<this._rootElements.length;i++){b=this._rootElements[i];d=c.event.findBySelector(b,
h);for(e in d){f=e?jQuery(e,b):[b];for(var k=0;k<f.length;k++)this.addCallbacks(f[k],d[e],j)&&g.push(f[k])}}this.add(g,a,j)}},addCallbacks:function(a,b,d){var e=c.data(a,"_dropData");if(e){if(!d){for(var f in b)e[f]=e[f]?e[f].concat(b[f]):b[f];return false}}else{c.data(a,"_dropData",new c.Drop(b,a));return true}},add:function(a,b,d){for(var e=0,f;e<a.length;){f=c.data(a[e],"_dropData");f.callHandlers(this.lowerName+"init",a[e],b,d);if(f._canceled)a.splice(e,1);else e++}this._elements.push.apply(this._elements,
a)},show:function(a,b,d){if(this._elements.length){var e=[],f=true,g=0,j,i,k,m=this.last_active;for(j=this;g<this._elements.length;)if(i=c.data(this._elements[g],"_dropData")){g++;j.isAffected(a,b,i)&&e.push(i)}else this._elements.splice(g,1);e.sort(this.sortByDeepestChild);d.stopRespondPropagate=function(){f=false};i=e.slice();this.last_active=e;for(a=0;a<m.length;a++){j=m[a];for(g=0;k=i[g];)if(j==k){i.splice(g,1);break}else g++;k||this.deactivate(j,b,d);if(!f)return}for(g=0;g<i.length;g++){this.activate(i[g],
b,d);if(!f)return}for(g=0;g<e.length;g++){this.move(e[g],b,d);if(!f)return}}},end:function(a,b){for(var d,e=this.lowerName+"end",f=0;f<this.last_active.length;f++){d=this.last_active[f];this.isAffected(a.vector(),b,d)&&d[this.endName]&&d.callHandlers(this.endName,null,a,b)}for(d=0;d<this._elements.length;d++)c.data(this._elements[d],"_dropData").callHandlers(e,null,a,b);this.clear()},clear:function(){this._elements.each(function(){c.removeData(this,"_dropData")});this._elements=c();delete this.dragging}});
c.Drag.responder=c.Drop;c.extend(c.Drop.prototype,{callHandlers:function(a,b,d,e){for(var f=this[a]?this[a].length:0,g=0;g<f;g++)this[a][g].call(b||this.element[0],d,this,e)},cache:function(a){this._cache=a!=null?a:true},cancel:function(){this._canceled=true}})})(jQuery);
