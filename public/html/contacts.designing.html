<head><script type="text/javascript" src="http://localhost:5555?[]&amp;_=0.36333488021045923"></script>
	<title>Designing Modules</title>
	<link rel="stylesheet" type="text/css" href="../documentjs/jmvcdoc/style.css">
	<link rel="shortcut icon" href="../documentjs/jmvcdoc/images/favicon.ico">
	<script type="text/javascript" src="http://www.google-analytics.com/ga.js"></script><script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-xxxxx-4']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
<link rel="stylesheet" href="file:////Users/bmoschel/tools/workspace/javascriptmvc/documentjs/jmvcdoc/style.css" type="text/css"><script src="http://jmvcs3.disqus.com/thread.js?url=file:////Users/bmoschel/tools/workspace/javascriptmvc/jmvc/docs.html?steal%5Bbrowser%5D=phantomjs&steal%5BstartFiles%5D=steal/browser/phantomjs/client.js#!jQuery.Controller&amp;title=&amp;sort=&amp;per_page&amp;category_id=&amp;developer=0&amp;identifier=#!jQuery.Controller&amp;disqus_version=1318875915&amp;1318970164014" charset="UTF-8"></script><link rel="stylesheet" type="text/css" href="http://mediacdn.disqus.com/1318875915/build/system//defaults.css"><script src="http://mediacdn.disqus.com/1318875915/build/system/disqus.js?" charset="UTF-8"></script></head><body>
<div id="documentation">
	<div id="top">
		<div class="topCorner">
			<div class="right"></div>
			<div class="left"></div>
		</div>
		<div class="content">
			<div id="searchRoundCorners">
				<div class="jmvcdoc_search"><input id="search" type="input"><span title="clear term" class="remove"></span></div>
			</div>
			<div id="defaults">
				<ul id="menu" class="ui-menu">
					<li class="ui-menu-item">
						<a class="menuLink" href="#favorites"><span class="menuSpan">Favorites</span></a>
					</li>
					<li class="ui-menu-item">
						<a class="menuLink" href="../follow.html" title="Follow"><span class="menuSpan red">Follow</span></a>
					</li>
					<li class="ui-menu-item">
						<a class="menuLink" href="../contribute.html" title="Contribute"><span class="menuSpan red">Contribute</span></a>
					</li>
					<li class="ui-menu-item">
						<a class="menuLink" href="../code.html" title="Code"><span class="menuSpan red">Code</span></a>
					</li>
				</ul>
			</div>
			<div class="logo-text"><a href="http://javascriptmvc.com"><img src="../documentjs/jmvcdoc/images/logo80x30.png" class="logo-image"></a></div>
		</div>
		<div class="bottomCorner">
			<div>&nbsp;</div>
		</div>
	</div>
	<div id="bottom">
		<div id="nav" class="jmvcdoc_nav">


	<div id="selected">
		    
				
		<div class="content">
			    <a href="#!" class="selected choice page" style="padding-left: 20px">
			    	
					JavaScriptMVC
					
				</a>
				
		</div>
			
		<div class="spacer"><div>&nbsp;</div></div>
			
			
				
		<div class="content">
			    <a href="#!examples" class="selected choice page" style="padding-left: 20px">
			    	
						<span class="remove" title="close"></span>
					
					Examples
					
				</a>
				
		</div>
			
		<div class="spacer"><div>&nbsp;</div></div>
			
			
				
		<div class="content">
			    <a href="#!contacts" class="selected choice page" style="padding-left: 20px">
			    	
						<span class="remove" title="close"></span>
					
					Contacts
					
				</a>
				
		</div>
			
			
	</div>

<div id="results" style="display: block">
	<div class="content">
	    
			
		    <a href="#!contacts.dc" class="result choice page" style="padding-left: 20px">
		    	Divide and Conquer
			</a>
			
		
			
		    <a href="#!contacts.designing" class="result choice page open" style="padding-left: 20px">
		    	Designing Modules
			</a>
			
		
			
		    <a href="#!contacts.glue" class="result choice page" style="padding-left: 20px">
		    	Gluing Modules Together
			</a>
			
		
	</div>
</div>


</div>
		<div id="doc_container">
			<div id="doc" class="jmvcdoc_content">
<div class="top">
	<div class="content">
	    <h1>Designing Modules&nbsp;
	    	<span class="page type"><span class="typeEnd">page</span></span>&nbsp;
	    	<span class="favorite favoriteoff">&nbsp;&nbsp;&nbsp;</span></h1>
	    
	    
	    
		
		
	</div>	
</div>


<p>Widgets should be dumb to whats going on around them. They should be self contained and provide an easy to use API for developers.  The first step in designing a widget is to define the input and outputs.</p>

<h2>Defining Inputs and Outputs</h2>

<p>Inputs are anything a widget consumes from the outside world.  This can include parameters passed (optional or required) or DOM events expected.  For example, a grid widget consumes parameters like page offset, initial sort, and column names.</p>

<p>Outputs are anything a widget visibly produces for the outside world.  This can include DOM created, events triggered, callback functions executed, data changed, etc.  For example, a grid widget might produce "pageChanged" or "columnSorted" events.</p>

<p>Let's examine the inputs and outputs of the <em>MXUI.Data.Grid</em> widget.</p>

<p><img class="image_tag" src="file:////Users/bmoschel/tools/workspace/javascriptmvc/tutorials/images/inputs_outputs.jpg"></p>

<h2>Anatomy of the List Module</h2>

<p>One of the reusable modules in the Contacts app is List. The List is a simple widget that takes a model, gets and lists data, and listens for updates to the items to update and/or destroy rows.</p>

<pre><code class=" javascript">$(<span class="string">"#category .list_wrapper"</span>).mxui_data_list({
    model : Contacts.Models.Category,
    show : <span class="string">"//contacts/views/categoryList"</span>,
    create: <span class="string">"//contacts/views/categoryCreate"</span>
})
</code></pre>

<p>In this app, the category, location, and company sections are all filters for the contacts grid. Upon clicking one of these rows, the grid is filtered with the selection. These lists are all managed using <em>MXUI.Data.List</em>.  We'll walk through how this widget works to illustrate creating reusable, self contained modules.</p>

<h3>Getting the List Data</h3>

<p>When initialized, you pass the List a [jQuery.model model] class.  JavaScriptMVC models have a standard API to perform CRUD operations.  Every model implements a <a href="#!jQuery.Model.static.findAll">findAll</a> method, which we can leverage to fetch data.</p>

<pre><code class=" javascript"><span class="keyword">this</span>.options.model.findAll(<span class="keyword">this</span>.options.params, <span class="keyword">this</span>.callback(<span class="string">'list'</span>))
</code></pre>

<p>If you look at the models in <em>contacts/models</em>, you'll notice findAll is missing. By default, models will request data using REST standards, as described in <a href="#!jquery.model.encapsulate">Service Encapsulation</a>. Every model has a findAll method, implemented in the based [jquery.model jQuery.Model] class.</p>

<h3>Drawing the List</h3>

<p>One of List's parameters is a 'list' template.  After the model has completed its <em>findAll</em>, we will take its results and draw the UI.</p>

<pre><code class=" javascript"><span class="keyword">this</span>.element.html(<span class="keyword">this</span>.options.list,{
    items : <span class="keyword">this</span>.options.sort ? items.sort(<span class="keyword">this</span>.options.sort) : items,
    options: <span class="keyword">this</span>.options
});
</code></pre>

<h3>Capturing Updates</h3>

<p>In a live application, data changes.  The List should be aware of these changes and update its UI accordingly.  List listens for updates for its given model and refreshes UI with the latest data.</p>

<pre><code class=" javascript"><span class="string">"{model} updated"</span> : <span class="function"><span class="keyword">function</span><span class="params">(model, ev, item)</span>{</span>
    <span class="keyword">var</span> el = item.elements(<span class="keyword">this</span>.element).html(<span class="keyword">this</span>.options.show, item);
    <span class="keyword">if</span>(<span class="keyword">this</span>.options.updated){
        <span class="keyword">this</span>.options.updated(<span class="keyword">this</span>.element, el, item)
    }
},
</code></pre>

<p>In the <a href="#!contacts.glue">Gluing Modules Together</a> section, we will discuss using this type of observer architecture.</p>

<h3>Responding to Clicks</h3>

<p>As items are clicked in the list, a "selected" visual state is applied to the item.</p>

<pre><code class=" javascript"><span class="string">".item {activateEvent}"</span> : <span class="function"><span class="keyword">function</span><span class="params">(el, ev)</span>{</span>
    <span class="keyword">if</span>(el.hasClass(<span class="string">"activated"</span>)){
        <span class="keyword">this</span>._deactivate(el)
    } <span class="keyword">else</span> {
        <span class="keyword">var</span> old = <span class="keyword">this</span>.find(<span class="string">".activated"</span>);
        <span class="keyword">this</span>._deactivate(old);
        <span class="keyword">this</span>._activate(el);
    }
},
_deactivate: <span class="function"><span class="keyword">function</span><span class="params">(el)</span>{</span>
    el.removeClass(<span class="string">"activated"</span>);
    el.trigger(<span class="string">"deactivate"</span>, el.model());
},
_activate: <span class="function"><span class="keyword">function</span><span class="params">(el)</span>{</span>
    el.addClass(<span class="string">"activated"</span>);
    el.trigger(<span class="string">"activate"</span>, el.model());
}
</code></pre>

<p>In the above code, we  trigger an <em>activate</em> event.  This event is one of List's outputs that we listen to using <a href="#!jquery.controller.listening">event delegation</a>.  As opposed to applications listening for "click" events, we use activate to provide a level of abstraction.  This allows the widget to provide other ways to activate a row, such as keyboard navigation or clicking.  We could even expand this widget to use touch events for mobile devices, and applications wouldn't have to change.  For more information on this you can read the <a href="#!mvc.controller">Controller</a> documentation. </p>

<p>The mission of this widget was simple: create a list of data that updates itself as the items change.  You and I have probably written this a dozen times in our applications.  This List widget provides a reusable API because it has generic and well defined inputs and outputs.</p>

<p>Next up, we will discuss how to <a href="#!contacts.glue">glue</a> our isolated modules into a full application.</p></div>
			<div id="disqus_thread"><div id="dsq-content-stub"><img width="71" height="17" alt="DISQUS" src="data:image/png;base64,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"><img width="16" height="11" alt="..." src="data:image/gif;base64,R0lGODlhEAALAPQAAP///z2LqeLt8dvp7u7090GNqz2LqV+fuJ/F1IW2ycrf51aatHWswaXJ14i4ys3h6FmctUCMqniuw+vz9eHs8fb5+meku+Tu8vT4+cfd5bbT3tbm7PH2+AAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh/hpDcmVhdGVkIHdpdGggYWpheGxvYWQuaW5mbwAh+QQJCwAAACwAAAAAEAALAAAFLSAgjmRpnqSgCuLKAq5AEIM4zDVw03ve27ifDgfkEYe04kDIDC5zrtYKRa2WQgAh+QQJCwAAACwAAAAAEAALAAAFJGBhGAVgnqhpHIeRvsDawqns0qeN5+y967tYLyicBYE7EYkYAgAh+QQJCwAAACwAAAAAEAALAAAFNiAgjothLOOIJAkiGgxjpGKiKMkbz7SN6zIawJcDwIK9W/HISxGBzdHTuBNOmcJVCyoUlk7CEAAh+QQJCwAAACwAAAAAEAALAAAFNSAgjqQIRRFUAo3jNGIkSdHqPI8Tz3V55zuaDacDyIQ+YrBH+hWPzJFzOQQaeavWi7oqnVIhACH5BAkLAAAALAAAAAAQAAsAAAUyICCOZGme1rJY5kRRk7hI0mJSVUXJtF3iOl7tltsBZsNfUegjAY3I5sgFY55KqdX1GgIAIfkECQsAAAAsAAAAABAACwAABTcgII5kaZ4kcV2EqLJipmnZhWGXaOOitm2aXQ4g7P2Ct2ER4AMul00kj5g0Al8tADY2y6C+4FIIACH5BAkLAAAALAAAAAAQAAsAAAUvICCOZGme5ERRk6iy7qpyHCVStA3gNa/7txxwlwv2isSacYUc+l4tADQGQ1mvpBAAIfkECQsAAAAsAAAAABAACwAABS8gII5kaZ7kRFGTqLLuqnIcJVK0DeA1r/u3HHCXC/aKxJpxhRz6Xi0ANAZDWa+kEAA7AAAAAAAAAAAA" style="margin:0 0 3px 5px"></div><div id="dsq-content" style="display: none; "></div></div>
      <a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>
		</div>
	</div>
</div>
<div id="low">
	<a href="http://jupiterit.com">� Jupiter Consulting - JavaScriptMVC Training and Support</a>
	<a class="api_links" href="http://javascriptmvc.com/docs/api.html#&amp;who=api"></a>
</div>
<script type="text/javascript">
	DOCS_LOCATION = "docs/" //adds searchData to this
	JMVCDOC_TIMESTAMP = 263793756
</script>
<script type="text/javascript" src="../steal/steal.js?documentjs/jmvcdoc">
</script>
<script type="text/javascript">
  window.disqus_identifier = window.location.hash;
  window.disqus_url = window.location.toString();
  steal('jquery/dom/route', 'http://jmvcs3.disqus.com/embed.js').then(function(){
    $.route.delegate('who', 'change', function(ev, attr, how, newVal, oldVal) {
		if (window.location.protocol !== "file:") { // avoid this for crawl script
			  DISQUS.reset({
			    reload: true,
			    config: function () {  
			      this.page.identifier = window.location.hash;  
			      this.page.url = window.location.toString();
			    }
			  });
	     }
    })
  });
</script>
<style type="text/css">
  body > iframe { width: 0;} 
  #dsq-content #dsq-form-area .dsq-attach-media-container iframe { height: 13px; padding: 0;}
</style>
	

</body>